var c=class{constructor(){this.baseObjects=[];this.assets={};this.dummyImg=new Image}loadAssets(t){return new Promise((e,i)=>{let s=0,n=0,d=()=>{n++,setTimeout(()=>{n===s&&e(!0)},1)},o=(m,a)=>{s++;let r=new Image;return r.src=m,r.onload=()=>{d(),a.h=a.h||r.height,a.w=a.w||r.width},r};t.forEach(this.prepareAsset(o))})}prepareAsset(t){return({id:e,src:i,states:s,w:n,h:d})=>{let o={w:n||0,h:d||0,id:e,img:this.dummyImg,states:{}},m=t(i,o);o.img=m,s&&Object.keys(s).forEach(a=>{let r,h=m;typeof s[a]=="string"?r={src:s[a]}:r=s[a],r.src&&(h=t(r.src,{})),o.states[a]={img:h,transform:r.transform}}),this.assets[e]=o}}setupCanvas(t){this.bg=t.bg||"#2c3e50",this.canvas=document.createElement("canvas"),this.canvas.id="game",this.canvas.width=t.w||800,this.canvas.height=t.h||450,document.body.appendChild(this.canvas);let e=this.canvas.getContext("2d");e&&(this.ctx=e),this.clearCanvas()}clearCanvas(){if(!this.ctx)throw new Error("Failed to get Canvas context, did you setupCanvas?");this.ctx.fillStyle=this.bg,this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height)}baseRender(t){this.baseObjects=t}locateAssetImageToRender(t){let{id:e,state:i}=t,s=this.assets[e];if(s){let n={...s};return i&&s.states[i]&&(n={...n,...s.states[i]}),n}return null}render(t){this.clearCanvas(),this.baseObjects.forEach(e=>this.renderAsset(e)),t.forEach(e=>this.renderAsset(e))}renderAsset(t){let e=this.locateAssetImageToRender(t);e?(console.log(e),e.transform?(console.log(this.ctx.getTransform()),console.log(e.transform),this.ctx.translate(t.x,t.y),this.ctx.transform(...e.transform),console.log(this.ctx.getTransform()),this.ctx.drawImage(e.img,0,0,e.w,e.h),this.ctx.resetTransform()):this.ctx.drawImage(e.img,t.x,t.y,e.w,e.h)):(this.ctx.fillStyle=this.bg,this.ctx.ellipse(t.x,t.y,t.w||50,t.h||50,Math.PI/4,0,2*Math.PI))}};window&&(window.DumbRenderer=c);var g=c;export{g as default};
